<!DOCTYPE html>
<html lang="zh-cn" >
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  
  <meta name="author"
        content="Jaswine"/>

  
  <meta name="description" content="æˆ‘ä»¬å†™çš„ä»£ç æœ€ç»ˆä»¥ä¸€ä¸ªè¿›ç¨‹çš„å½¢å¼è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¸Šï¼Œæˆ‘ä»¬çš„è¿›ç¨‹è¦ä¾èµ–æ“ä½œç³»ç»Ÿå®Œæˆä¸€äº›å·¥ä½œï¼Œæ­¤æ—¶è¿›ç¨‹ä¾¿ä¼šè¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼ŒLinuxç³»ç»Ÿä¸‹æä¾›straceæ¥æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨ä¿¡æ¯ï¼Œä»¥æ­¤æ¥æŸ¥çœ‹Java æä¾›çš„IOåœ¨æ“ä½œç³»ç»Ÿå±‚é¢æ˜¯ä»€ä¹ˆæƒ…å†µ
"/>
  

  
  
  <meta name="keywords" content="Hugo, theme, zozo"/>
  

  
  <link rel="canonical" href="https://jaswine.com/blog/posts/tools/strace/"/>

  

  <title>ã€ŒğŸæ¢ç©¶ã€ä½¿ç”¨straceæ¥æ¢ç©¶Java I/Oåœ¨æ“ä½œç³»ç»Ÿå±‚é¢çš„è°ƒç”¨ &middot; Jaswine</title>

  
  <link rel="shortcut icon" href="https://jaswine.com/blog/images/J.png" />
  <link rel="stylesheet" href="https://jaswine.com/blog/css/animate.min.css"/>
  <link rel="stylesheet" href="https://jaswine.com/blog/css/remixicon.css"/>
  <link rel="stylesheet" href="https://jaswine.com/blog/css/zozo.css"/>
  <link rel="stylesheet" href="https://jaswine.com/blog/css/highlight.css"/>

  
  
</head>

<body>
<div class="main animated">
  <div class="nav_container animated fadeInDown">
  <div class="site_nav" id="site_nav">
    <ul>
      
      <li>
        <a href="/blog/">é¦–é¡µ</a>
      </li>
      
      <li>
        <a href="/blog/posts/">å½’æ¡£</a>
      </li>
      
      <li>
        <a href="/blog/tags/">æ ‡ç­¾</a>
      </li>
      
      <li>
        <a href="/blog/about/">å…³äº</a>
      </li>
      
      <li>
        <a href="/blog/senior/">å‰è¾ˆ</a>
      </li>
      
    </ul>
  </div>
  <div class="menu_icon">
    <a id="menu_icon"><i class="remixicon-links-line"></i></a>
  </div>
</div>

  <div class="header animated fadeInDown">
  <div class="site_title_container">
    <div class="site_title">
      <h1>
        <a href="https://jaswine.com/blog/">
          <span>Jaswine</span>
          
          <img src="https://cdn.jaswine.com/www/logo.svg" width="50px" />
          
        </a>
      </h1>
    </div>
    <div class="description">
      <p class="sub_title">Try Everything Different In My Life.</p>
      <div class="my_socials">
        
        
        <a href="https://github.com/Jaswine" title="github" target="_blank"><i class="remixicon-github-fill"></i></a>
        
        
        
        <a href="https://www.instagram.com/jaswine_wang/" title="instagram" target="_blank"><i class="remixicon-instagram-fill"></i></a>
        
        
        
        <a href="https://twitter.com/Jaswine_Wang" title="twitter" target="_blank"><i class="remixicon-twitter-fill"></i></a>
        
        
        
        <a href="https://www.zhihu.com/people/jasmine217" title="zhihu" target="_blank"><i class="remixicon-zhihu-fill"></i></a>
        
        
        <a href="https://jaswine.com/blog/index.xml" type="application/rss+xml" title="rss" target="_blank"><i class="remixicon-rss-fill"></i></a>
      </div>
    </div>
  </div>
</div>

  <div class="content">
    <div class="post_page">
      <div class="post animated fadeInDown">
        <div class="post_title post_detail_title">
          <h2><a href='/blog/posts/tools/strace/'>ã€ŒğŸæ¢ç©¶ã€ä½¿ç”¨straceæ¥æ¢ç©¶Java I/Oåœ¨æ“ä½œç³»ç»Ÿå±‚é¢çš„è°ƒç”¨</a></h2>
          <span class="date">2020.07.23</span>
        </div>
        <div class="post_content markdown"><p>æˆ‘ä»¬å†™çš„ä»£ç æœ€ç»ˆä»¥ä¸€ä¸ªè¿›ç¨‹çš„å½¢å¼è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¸Šï¼Œæˆ‘ä»¬çš„è¿›ç¨‹è¦ä¾èµ–æ“ä½œç³»ç»Ÿå®Œæˆä¸€äº›å·¥ä½œï¼Œæ­¤æ—¶è¿›ç¨‹ä¾¿ä¼šè¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼ŒLinuxç³»ç»Ÿä¸‹æä¾›straceæ¥æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨ä¿¡æ¯ï¼Œä»¥æ­¤æ¥æŸ¥çœ‹Java æä¾›çš„IOåœ¨æ“ä½œç³»ç»Ÿå±‚é¢æ˜¯ä»€ä¹ˆæƒ…å†µ</p>

<!-- TOC -->

<ul>
<li><a href="#bioä½¿ç”¨å¤šçº¿ç¨‹å®ç°éé˜»å¡">BIO(ä½¿ç”¨å¤šçº¿ç¨‹å®ç°éé˜»å¡)</a>

<ul>
<li><a href="#ç¤ºä¾‹ä»£ç ">ç¤ºä¾‹ä»£ç </a></li>
<li><a href="#straceæŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨">straceæŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨</a></li>
</ul></li>
<li><a href="#æ€»ç»“">æ€»ç»“</a>

<ul>
<li><a href="#bioå¤šçº¿ç¨‹éé˜»å¡">BIO(å¤šçº¿ç¨‹éé˜»å¡)</a>

<ul>
<li><a href="#å®ç°é€»è¾‘">å®ç°é€»è¾‘</a></li>
<li><a href="#ä¼˜ç‚¹">ä¼˜ç‚¹</a></li>
<li><a href="#ç¼ºç‚¹">ç¼ºç‚¹</a></li>
</ul></li>
</ul></li>
<li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
</ul>

<!-- /TOC -->

<h2 id="bio-ä½¿ç”¨å¤šçº¿ç¨‹å®ç°éé˜»å¡">BIO(ä½¿ç”¨å¤šçº¿ç¨‹å®ç°éé˜»å¡)</h2>

<h3 id="ç¤ºä¾‹ä»£ç ">ç¤ºä¾‹ä»£ç </h3>

<pre><code class="language-Java">import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.InetSocketAddress;
import java.net.ServerSocket;
import java.net.Socket;

/**
 * @author : Jaswine
 * @date : 2020-07-23 13:04
 **/
public class Test {

	public static void main(String[] args) throws IOException {

		ServerSocket socket = new ServerSocket();		
		socket.bind(new InetSocketAddress(8888));
		System.out.println(&quot;æ–°å»ºçš„socket8888&quot;);
		while (true){
			Socket client = socket.accept();
			System.out.println(&quot;client&quot; + client.getPort());

			new Thread(() -&gt; {
				try {
					BufferedReader reader = new BufferedReader(new InputStreamReader(client.getInputStream()));
					while (true){
						System.out.println(reader.readLine());
					}
				} catch (IOException e) {
					e.printStackTrace();
				}
			}).start();
		}
	}
}

</code></pre>

<p>ä»£ç å¾ˆç®€å•ï¼Œå¼€å¯ä¸€ä¸ª<code>ServerSocket</code>ç»‘å®š8888ç«¯å£ï¼Œç„¶åç­‰å¾…è¿æ¥ã€‚</p>

<h3 id="straceæŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨">straceæŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨</h3>

<blockquote>
<p>å…³äºstraceçš„ç”¨æ³•å‚è€ƒ:</p>

<p><a href="https://man.linuxde.net/strace">ğŸ”— strace - Linuxå‘½ä»¤Doc</a></p>
</blockquote>

<pre><code class="language-shell">## 1.ç¼–è¯‘Test.java
javac Test.java

## 2.è¿è¡Œ
strace -ff -o ./test java Test
</code></pre>

<p>ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä»¥<code>test.</code>å¼€å¤´ï¼Œçº¿ç¨‹å·ç ç»“å°¾çš„æ–‡ä»¶</p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-1.png" alt="" /></p>

<p>ä½¿ç”¨<code>JPS</code>æŸ¥çœ‹å½“å‰çš„<code>Java</code>è¿›ç¨‹ï¼Œè¿›ç¨‹å·ä¸º2592</p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-2.png" alt="" /></p>

<p>æ‰“å¼€<code>test.2592</code>æ–‡ä»¶,å‘ç°æœ€åä½¿ç”¨<code>clone</code>å‡½æ•°å¼€å¯äº†æ–°è¿›ç¨‹2593</p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-3.png" alt="" /></p>

<p>ç°åœ¨æ‰“å¼€<code>test.2593</code>ï¼Œå‘è°ƒç”¨äº†<code>socket</code>å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªç½‘ç»œsocket</p>

<blockquote>
<p>socketå‡½æ•°æˆåŠŸæˆåŠŸåæ‚”åˆ›å»ºä¸€ä¸ªæŒ‡å‘socketçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œçœ‹åˆ°æŒ‡å‘çš„æ–‡ä»¶æè¿°ç¬¦ä¸º 5</p>
</blockquote>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-4.png" alt="" /></p>

<p>åœ¨Linuxç³»ç»Ÿä¸­ä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶ï¼Œåˆ°å½“å‰è¿›ç¨‹çš„ç›®å½•æ–‡ä»¶ä¸‹çœ‹ä¸€çœ‹åˆ°è¯¥æ–‡ä»¶</p>

<pre><code class="language-shell">cd /proc/2592/fd
</code></pre>

<blockquote>
<p>å…¶ä¸­0ï¼Œ1ï¼Œ2æ˜¯Linuxç³»ç»Ÿçš„æ ‡å‡†è¾“å‡ºï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½ä¼šæœ‰è¿™ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦</p>
</blockquote>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-6.png" alt="" /></p>

<p>å†çœ‹ç³»ç»Ÿè°ƒç”¨çš„ç§’é€Ÿæ–‡ä»¶ï¼Œçœ‹åˆ°è°ƒç”¨äº†bindå‡½æ•°ç»‘å®šäº†8888ç«¯å£ï¼Œå°†å½“å‰socketå’Œæ–‡ä»¶æè¿°ç¬¦ä¸º5çš„æ–‡ä»¶è¿›è¡Œäº†ç»‘å®šï¼Œç„¶åsocketå¤„äºlistençŠ¶æ€</p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-7.png" alt="" /></p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-10.png" alt="" /></p>

<p>ä½¿ç”¨å‘½ä»¤è¡Œå¯ä»¥æŸ¥çœ‹ å ç”¨ 8888 ç«¯å£çš„åº”ç”¨ç¨‹åºçŠ¶æ€</p>

<pre><code class="language-SHELL">netstat -anp | grep 8888
</code></pre>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-8.png" alt="" /></p>

<p>æ­¤æ—¶æˆ‘ä»¬è¿æ¥è¿™ä¸ªsocketæœåŠ¡,ä¼šå‡ºç°ä»¥ä¸‹çš„ç°è±¡</p>

<pre><code class="language-shell">nc localhost 8888
</code></pre>

<ul>
<li>ç»ˆç«¯ä¼šæ‰“å°å‡ºè¿æ¥è¿›æ¥å®¢æˆ·ç«¯çš„ç«¯å£</li>
<li>åœ¨è¿›ç¨‹çš„ç›®å½•ä¸‹çš„fdæ–‡ä»¶ä¸­ä¼šæ–°å‡ºç°ä¸€ä¸ªæŒ‡å‘socketçš„æ–‡ä»¶æè¿°ç¬¦</li>
<li>åœ¨test.2593ä¸­æ˜¾ç¤ºè¿™ä¸ªç¨‹åºæ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨</li>
<li>ä½¿ç”¨netstatæŸ¥çœ‹ç½‘ç»œä¼šå‘ç°ä¸€ä¸ªå»ºç«‹è¿æ¥çš„TCP</li>
</ul>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-11.png" alt="" />
<center>ç¨‹åºç»ˆç«¯è¾“å‡º</center>
<img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-12.png" alt="" />
<center>acceptå‡½æ•°</center>
<img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-13.png" alt="" />
<center>æ–°çš„æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘socket</center>
<img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-14.png" alt="" />
<center>æ–°å»ºçš„ç½‘ç»œè¿æ¥</center></p>

<p>å› ä¸ºæˆ‘ä»¬ä»£ç æ˜¯ç”¨å¤šçº¿ç¨‹æ¥æ¥æ”¶å®¢æˆ·ç«¯è¾“å…¥ï¼Œæ‰€ä»¥åœ¨ä¸»ç¨‹æœ€åå‘ç°å°†ioäº¤ç»™äº†æ–°çš„çº¿ç¨‹</p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-15.png" alt="" /></p>

<p>æˆ‘ä»¬æ‰“å¼€ä¸Šé¢è¯´çš„çº¿ç¨‹å·ä¸º4160çš„testæ–‡ä»¶,å‘ç°è¢«recvfromå‡½æ•°é˜»å¡ä½ï¼Œç­‰å¾…æ–‡ä»¶æè¿°ç¬¦ä¸º6çš„æ–‡ä»¶</p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-16.png" alt="" /></p>

<p>å½“æˆ‘ä»¬è¾“å…¥<code>jaswine</code>çš„æ—¶å€™ï¼Œå‘ç°test.4160æ–‡ä»¶æ‹¿åˆ°å®¢æˆ·ç«¯è¾“å…¥ä¹‹ååˆè¿›å…¥recvfromå‡½æ•°ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€</p>

<p><img src="https://cdn.jaswine.com/Web/Blog/explore/io/io-17.png" alt="" /></p>

<!-- 
æœ€åæˆ‘ä»¬çœ‹åˆ°ç³»ç»Ÿè°ƒç”¨äº†`poll`å‡½æ•°åå°±æ²¡æœ‰äº†

> poll()å‡½æ•°ä¼š

![](https://cdn.jaswine.com/Web/Blog/explore/io/io-9.png)
 -->

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>Javaçš„IOå°±æ˜¯æ“ä½œç³»ç»Ÿçš„åº•å±‚å°è£…ã€‚</p>

<h3 id="bio-å¤šçº¿ç¨‹éé˜»å¡">BIO(å¤šçº¿ç¨‹éé˜»å¡)</h3>

<h4 id="å®ç°é€»è¾‘">å®ç°é€»è¾‘</h4>

<p>åœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨</p>

<pre><code class="language-java">ServerSocket serverSocket = new ServerSocket(8888);
</code></pre>

<p>åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šå‘ç”Ÿäº†ä»¥ä¸‹çš„æ“ä½œ
ä½¿ç”¨<code>socket</code>å‡½æ•°è¿”å›äº†ä¸€ä¸ªsocketå¥—æ¥å­—ï¼Œè¿™ä¸ªå¥—æ¥å­—æŒ‡å‘è¿›ç¨‹<code>fd</code>ç›®å½•ä¸‹çš„ä¸€ä¸ªå…·ä½“æ–‡ä»¶(Linuxä¸­ä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶),ç„¶åä½¿ç”¨bindå‡½æ•°ç»‘å®šå¯¹åº”çš„ç«¯å£ï¼Œä½¿ç”¨listenå‡½æ•°è¿›è¡Œç›‘å¬ã€‚</p>

<p>å½“æœ‰å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯çš„æ—¶å€™</p>

<pre><code>nc localhost 8888
</code></pre>

<p>è°ƒç”¨serverSocketçš„accept()æ–¹æ³•ä¹‹åæ“ä½œç³»ç»Ÿæ‰§è¡Œacceptæ–¹æ³•è¿”å›ä¸€ä¸ªsocketï¼Œå› ä¸ºæ˜¯ä½¿ç”¨å¤šçº¿ç¨‹ç”Ÿæˆä¸€ä¸ªå­çº¿ç¨‹ï¼Œå°†ä¿¡æ¯å¤åˆ¶åˆ°å­çº¿ç¨‹ä¸­ç„¶åå­çº¿ç¨‹è°ƒç”¨revcfromæ–¹æ³•é˜»å¡ä½ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¾“å…¥ã€‚</p>

<p>å½“å®¢æˆ·ç«¯è¾“å…¥çš„æ—¶å€™ï¼Œè°ƒç”¨readæ–¹æ³•å°†æ•°æ®è¯»å‡ºæ¥ï¼Œç„¶åå¤„ç†å®Œå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘å†æ¬¡æ‰§è¡Œrevcfromæ–¹æ³•é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯çš„è¾“å…¥ã€‚</p>

<h4 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h4>

<p>ä»£ç é€»è¾‘ç®€å•</p>

<h4 id="ç¼ºç‚¹">ç¼ºç‚¹</h4>

<p>å½“æœ‰å¾ˆå¤šå®¢æˆ·ç«¯çš„æ—¶å€™è¦ç”Ÿæˆå¾ˆå¤šå­çº¿ç¨‹</p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<p><a href="https://man.linuxde.net/strace">ğŸ”— strace - Linuxå‘½ä»¤Doc</a></p>

<p><a href="https://developer.ibm.com/zh/tutorials/l-lpic1-103-4/">ğŸ”— Linuxç³»ç»Ÿä¸­æµã€ç®¡é“å’Œé‡å®šå‘ -- IBM Developer</a></p>

<p><a href="https://en.wikipedia.org/wiki/Poll_(Unix)">ğŸ”— poll(UNIX) -- ç»´åŸºç™¾ç§‘</a></p>

<p><a href="https://man7.org/linux/man-pages/man2/recvfrom.2.html">ğŸ”— recvfrom -- Linux Man</a></p></div>
        <div class="post_footer">
          
          <div class="meta">
            <div class="info">
              <span class="field tags">
                <i class="remixicon-stack-line"></i>
                
                <a href="https://jaswine.com/blog/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ</a>
                
                <a href="https://jaswine.com/blog/tags/linux/">Linux</a>
                
                <a href="https://jaswine.com/blog/tags/java/">Java</a>
                
                <a href="https://jaswine.com/blog/tags/i/o/">I/O</a>
                
              </span>
            </div>
          </div>
          
        </div>
      </div>
      
      
    </div>
  </div>
  <a id="back_to_top" href="#" class="back_to_top"><span>â–³</span></a>
</div>
<footer class="footer">
  <div class="powered_by">
    <a href="https://zeuk.me">Designed by Zeuk,</a>
    <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
  </div>

  <div class="footer_slogan">
    <span></span>
  </div>
</footer>



<script src="https://jaswine.com/blog/js/jquery-3.3.1.min.js"></script>
<script src="https://jaswine.com/blog/js/zozo.js"></script>
<script src="https://jaswine.com/blog/js/highlight.pack.js"></script>
<link  href="https://jaswine.com/blog/css/fancybox.min.css" rel="stylesheet">
<script src="https://jaswine.com/blog/js/fancybox.min.js"></script>

<script>hljs.initHighlightingOnLoad()</script>


  <script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>






</body>
</html>
